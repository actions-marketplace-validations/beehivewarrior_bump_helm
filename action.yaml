name: 'Bump Chart Version'
description: 'Automatically Bump Helm Chart Version'
inputs:
  chart_name:
    description: 'Chart to be bumped'
    required: true
  bump_strategy:
    description: 'How the chart should be bumped'
    required: false
    default: 'PATCH'

runs:
  using: composite
  steps:
    - name: "Run Point"
      env:
        BUMP_STRATEGY: ${{ inputs.bump_strategy }}
        CHART_NAME: ${{ inputs.chart_name }}
      shell: bash
      run: |
        entrypoint="import sys;
        import subprocess;
        from pathlib import Path;
        MAIN_SCRIPT = Path(r'${GITHUB_ACTION_PATH}') / 'auto_bump' / 'main.py';
        proc = subprocess.run([sys.executable, str(MAIN_SCRIPT)]);
        sys.exit(proc.returncode)
        "
        if [ "$RUNNER_OS" == "Windows" ]; then
          echo $entrypoint | python
        else
          echo $entrypoint | python3
        fi